{% extends "base.html" %}
{% block content %}
<h2>Chat with Counsellor</h2>
<div id="chat-box" class="border p-3 mb-3" style="height: 300px; overflow-y: scroll;"></div>
<form id="chat-form">
    <div class="input-group">
        <input type="text" id="message" class="form-control" placeholder="Type your message" required>
        <button type="submit" class="btn btn-primary">Send</button>
    </div>
</form>
<script>
    document.getElementById('chat-form').addEventListener('submit', async (e) => {
        e.preventDefault();
        const message = document.getElementById('message').value;
        document.getElementById('chat-box').innerHTML += `<p><strong>You:</strong> ${message}</p>`;
        const response = await fetch('/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
            body: `message=${encodeURIComponent(message)}`
        });
        const data = await response.json();
        document.getElementById('chat-box').innerHTML += `<p><strong>Counsellor:</strong> ${data.response}</p>`;
        document.getElementById('message').value = '';
    });
</script>
{% endblock %}